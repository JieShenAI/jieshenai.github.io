---
title: 文章编辑结构
date: 2022-08-29 14:53:13
categories: autoWriteDesign
tags:
---

# 文章结构设计



## vuex

> 选择vuex而不是全局总线，因为vuex可以集中进行管理



## 编辑组件

初始显示框 - 编辑框 - 显示框

初始显示框的内容固定。因为其中包含了很多从数据库读入的数据。

编辑框的初始数据来自显示初始显示框。

最后汇总的数据的只有编辑框的文本。

 

需要一个组件，把文本的字符传给组件。使用v-for循环，在页面上展示。

给组件传值后，在组件内若想修改该值，如何同步修改；

每一个组件内部还会有很多待从数据库读入的参数，他们的参数名



如何获取当前编辑组件在 v-for 中的index



### 修改

父组件将内容传递给子组件，在子组件中修改了数据后，如何将子组件的内容同步上去。



## 保存到浏览器

将数据保存到浏览器中



# 取消编辑

像背景这个每个地方不同的文字，不能写在html中，可存放在数据库中，然后读取出来。

文字写入到html里面。将文字内容从html中读取出来，装进对象里。

再把对象，通过ajax发送到服务器，再由服务器把这个导出。



## 数据库 

为了实现在更改了数据库中的数据之后，刷新页面的时候，页面上会显示新的数据。采用每次导出时，我们会向数据库请求全部最新的数据进行网页的渲染。

## 总页预览

用户点击导出之后，跳转到一个页面去，那个页面汇总了每个章节的内容。用户再点击确认导出。直接把那个页面缓存的数据发到服务器。

父组件是总页面，子组件是每个分章。这样的话，子组件就需要把数据挂载到父组件身上。



背景之类的，每个城市不同的数据，应该存在数据库中。

测试，网络请求得到数据后，依然能够保持将数据进行传递给父组件。

### 设计缺陷

在`OutPrint.vue`组件中，采用双重for循环导出dom元素

```javascript
let nodes = this.$refs.content.childNodes
for (let node of nodes) {
    for (let n of node.childNodes) {
        console.log(n.tagName, n.innerText);
    }
}
```

组件格式：

```html
<div>
    <h3>（一）基本经济指标</h3>
    <h4>1. 地区生产总值</h4>
    <p>
      2021年恩施实现地区生产总值{{ gdp }}亿元，按可比价格计算，比上年增长{{ gdpIncrease }}%（名义增速16.5%），
      经济总量和增速在湖北省地级行政区位居第11位和第5位，高于同年{{ provinceGdpIncrease }}%的全省平均增速；
    </p>
 	...
</div>
```

`OutPrint.vue`格式:

```html
<div>
    <h1>恩施土家族苗族自治州产业发展总体规划 2025-2035</h1>
</div>
```

必须是 div 容器下，立即接着 p|hx 容器。



## 待处理

* 痛点一

    ```
    this.avgGdp = obj.avgGdp
    this.avgProvinceGdp = obj.avgProvinceGdp
    this.cityID = obj.cityID
    this.countryGdp = obj.countryGdp
    this.countryGdpIncrease = obj.countryGdpIncrease
    this.gdp = obj.gdp
    this.gdpIncrease = obj.gdpIncrease
    this.provinceGdp = obj.provinceGdp
    this.provinceGdpIncrease = obj.provinceGdpIncrease
    this.year = obj.year
    ```

    每一个都写初始化，这样太麻烦了。能否使用 `...obj`，直接一步到位。
